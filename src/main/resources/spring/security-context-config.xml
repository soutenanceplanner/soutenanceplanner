<?xml version="1.0" encoding="UTF-8"?>
<beans:beans xmlns="http://www.springframework.org/schema/security"
	xmlns:beans="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://www.springframework.org/schema/beans 
                    http://www.springframework.org/schema/beans/spring-beans-4.0.xsd
                    http://www.springframework.org/schema/security 
                    http://www.springframework.org/schema/security/spring-security-3.2.xsd">

	<!-- hasRole([role]) Returns true if the current principal has the specified 
		role. hasAnyRole([role1,role2]) Returns true if the current principal has 
		any of the supplied roles (given as a comma-separated list of strings) principal 
		Allows direct access to the principal object representing the current user 
		authentication Allows direct access to the current Authentication object 
		obtained from the SecurityContext permitAll Always evaluates to true denyAll 
		Always evaluates to false isAnonymous() Returns true if the current principal 
		is an anonymous user isRememberMe() Returns true if the current principal 
		is a remember-me user isAuthenticated() Returns true if the user is not anonymous 
		isFullyAuthenticated() Returns true if the user is not an anonymous or a 
		remember-me user -->

	<beans:bean id="authenticationEntryPoint"
		class="com.angers.m2sili.soutenance.web.security.Http401DeniedEntryPoint" />

	<beans:bean id="userDetailsService"
		class="com.angers.m2sili.soutenance.web.security.CustomUserDetailsService" />
		
	<beans:bean class="com.angers.m2sili.soutenance.web.security.AuthenticationTokenProcessingFilter" id="authenticationTokenProcessingFilter">
		<beans:constructor-arg ref="userDetailsService" />
	</beans:bean>

	<beans:bean id="passwordEncoder"
		class="org.springframework.security.crypto.password.StandardPasswordEncoder">
 		<beans:constructor-arg value="encodeM2s1l1passSoIcanNNnn00tCHangeIt$1" />
	</beans:bean>

	<authentication-manager id="authenticationManager">
		<authentication-provider
			user-service-ref="userDetailsService">
			<!-- <password-encoder ref="passwordEncoder"></password-encoder> -->
		</authentication-provider>
	</authentication-manager>

	<http realm="Protected API" use-expressions="true"
		auto-config="false" create-session="stateless" entry-point-ref="authenticationEntryPoint"
		authentication-manager-ref="authenticationManager">
		<custom-filter ref="authenticationTokenProcessingFilter"
			position="FORM_LOGIN_FILTER" />
	</http>

</beans:beans>